{"version":3,"file":"static/js/3.chunk.js","sources":["/Users/naruto/Desktop/mycode/study-notes/src/views/admin/article/manage/index.less","/Users/naruto/Desktop/mycode/study-notes/src/views/admin/article/manage/index.jsx","webpack:///./src/views/admin/article/manage/index.less?6637","/Users/naruto/Desktop/mycode/study-notes/src/views/admin/article/manage/queryForm.jsx"],"sourcesContent":["exports = module.exports = require(\"../../../../../node_modules/_css-loader@1.0.0@css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".manager .btn-edit {\\n  cursor: pointer;\\n  color: #1890ff;\\n}\\n.manager .btn-delete {\\n  cursor: pointer;\\n  color: #f00;\\n}\\n.query-form {\\n  margin-bottom: 20px;\\n}\\n.query-form .form-select {\\n  min-width: 140px;\\n}\\n.query-form .form-checkbox-wrap {\\n  padding-left: 20px;\\n}\\n\", \"\"]);\n\n// exports\n","import React, { Component } from 'react'\nimport './index.less'\n\nimport { connect } from 'react-redux'\nimport { Link } from 'react-router-dom'\n\nimport { random, getCommentsCount } from '@/lib'\nimport { Table, Divider, Tag, Modal, message, Badge, Button } from 'antd'\nimport QueryForm from './queryForm'\nimport moment from 'moment'\n\n@connect(state => ({\n  colorList: state.common.colorList,\n  tagList: state.article.tagList\n}))\nclass Manager extends Component {\n  state = {\n    colorMap: {},\n    list: [],\n    pagination: {},\n    total: 0,\n    loading: false\n  }\n\n  componentDidMount() {\n    const { colorList, tagList } = this.props\n    let colorMap = {}\n    tagList.forEach(item => {\n      colorMap[item.name] = colorList[random(colorList)]\n    })\n    this.setState({ colorMap }, () => this.fetchList({ page: 1 }))\n  }\n\n  getColumns = () => {\n    // const { colorMap } = this.state\n    return [\n      {\n        title: '标题',\n        dataIndex: 'title'\n      },\n      {\n        title: '标签',\n        dataIndex: 'tags',\n        render: (text, record) => {\n          return text.map(d => (\n            <Tag color={this.state.colorMap[d.name]} key={d.name}>\n              {d.name}\n            </Tag>\n          ))\n        }\n      },\n      {\n        title: '分类',\n        dataIndex: 'categories',\n        render: (text, record) => {\n          return text.map(d => (\n            <Tag color={'#2db7f5'} key={d.name}>\n              {d.name}\n            </Tag>\n          ))\n        }\n      },\n      {\n        title: '评论数',\n        dataIndex: 'comments',\n        render: text => {\n          const count = getCommentsCount(text)\n          return count !== 0 ? <Badge count={count} style={{ backgroundColor: '#52c41a' }} /> : count\n        },\n        sorter: (a, b) => getCommentsCount(a.comments) - getCommentsCount(b.comments)\n      },\n      {\n        title: '发布时间',\n        dataIndex: 'createdAt',\n        sorter: (a, b) => (moment(a.createdAt).isBefore(b.createdAt) ? 1 : -1)\n      },\n      {\n        title: '修改时间',\n        dataIndex: 'updatedAt',\n        sorter: (a, b) => (moment(a.updatedAt).isBefore(b.updatedAt) ? 1 : -1)\n      },\n      {\n        title: '置顶',\n        dataIndex: 'showOrder',\n        render: (text, record) =>\n          text ? (\n            <Button size=\"small\" type=\"danger\" onClick={() => this.setTop(record)}>\n              取消置顶\n            </Button>\n          ) : (\n            <Button size=\"small\" type=\"dashed\" onClick={() => this.setTop(record)}>\n              置顶文章\n            </Button>\n          )\n      },\n      {\n        title: '操作',\n        render: (text, record) => {\n          return (\n            <div className=\"action\">\n              <Link to={`/article/${record.id}`}>查看</Link>\n              <Divider type=\"vertical\" />\n              {/* <span className=\"btn-edit\">编辑</span> */}\n              <Link to={{ pathname: '/admin/articles/edit', state: { articleId: record.id } }}>编辑</Link>\n              <Divider type=\"vertical\" />\n              <span className=\"btn-delete\" onClick={() => this.handleDelete(record.id, record.title)}>\n                删除\n              </span>\n            </div>\n          )\n        }\n      }\n    ]\n  }\n\n  /**\n   * 设置置顶文章\n   *\n   * @memberof Manager\n   */\n  setTop = record => {\n    const showOrder = record.showOrder ? 0 : 1\n    this.axios.put('/article/update', {\n      articleId: record.id,\n      showOrder\n    }).then(() => {\n      const list = this.state.list\n      const target = list.find(d => d.id === record.id)\n      target.showOrder = showOrder\n      this.setState({ list })\n    })\n  }\n\n  fetchList = ({ current = 1, pageSize = 10, ...query }) => {\n    this.setState({ loading: true })\n\n    this.axios.get('/article/getList', { params: { page: current, pageSize, ...query } }).then(res => {\n      const pagination = {\n        current,\n        pageSize,\n        total: res.count\n      }\n      this.setState({ list: res.rows, pagination, loading: false })\n    })\n  }\n\n  handleChange = pagination => {\n    this.fetchList({ ...pagination, ...this.state.query })\n  }\n\n  /**\n   * @param {Number} - 文章 id\n   */\n  handleDelete = (articleId, title) => {\n    Modal.confirm({\n      title: '您确认删除该文章?，此操作不可恢复！',\n      content: `文章： ${title} `,\n      onOk: () => {\n        this.axios.delete('/article/delete', { params: { articleId } }).then(res => {\n          if (res.code === 200) {\n            this.fetchList(this.state.pagination)\n            message.success(res.message)\n          }\n        })\n      }\n    })\n  }\n\n  getQuery = query => {\n    this.setState({ query })\n\n    this.fetchList({ ...query, current: 1 })\n  }\n\n  render() {\n    const { list, pagination, loading } = this.state\n    return (\n      <div className=\"manager\">\n        <QueryForm getQuery={this.getQuery} />\n        <Table\n          rowKey=\"id\"\n          bordered\n          loading={loading}\n          columns={this.getColumns()}\n          dataSource={list}\n          pagination={pagination}\n          onChange={this.handleChange}\n        />\n      </div>\n    )\n  }\n}\n\nexport default Manager\n","\nvar content = require(\"!!../../../../../node_modules/_css-loader@1.0.0@css-loader/index.js??ref--6-oneOf-3-1!../../../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??postcss!../../../../../node_modules/_less-loader@4.1.0@less-loader/dist/cjs.js??ref--6-oneOf-3-3!./index.less\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/_style-loader@0.23.0@style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/_css-loader@1.0.0@css-loader/index.js??ref--6-oneOf-3-1!../../../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??postcss!../../../../../node_modules/_less-loader@4.1.0@less-loader/dist/cjs.js??ref--6-oneOf-3-3!./index.less\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/_css-loader@1.0.0@css-loader/index.js??ref--6-oneOf-3-1!../../../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??postcss!../../../../../node_modules/_less-loader@4.1.0@less-loader/dist/cjs.js??ref--6-oneOf-3-3!./index.less\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\n\nimport { Button, Form, Input, Select, DatePicker, Checkbox, Radio } from 'antd'\nimport FormBuilder from '@/components/helper/FormBuilder'\nimport { connect } from 'react-redux'\nimport moment from 'moment'\n\nconst RangePicker = DatePicker.RangePicker\nconst Option = Select.Option\n\n@connect(state => state.article)\nclass QueryForm extends Component {\n  static propTypes = {\n    getQuery: PropTypes.func.isRequired\n  }\n\n  getFormMeta = () => {\n    return {\n      colon: true,\n      elements: [\n        {\n          key: 'title',\n          label: '标题',\n          widget: <Input placeholder=\"请输入文章标题\" />\n        },\n        {\n          key: 'tag',\n          label: '标签',\n          widget: (\n            <Select className=\"form-select\" allowClear>\n              {this.props.tagList.map(item => (\n                <Option key={item.name} value={item.name}>\n                  {item.name}\n                </Option>\n              ))}\n            </Select>\n          )\n        },\n        {\n          key: 'category',\n          label: '分类',\n          widget: (\n            <Select className=\"form-select\" allowClear>\n              {this.props.categoryList.map(item => (\n                <Option key={item.name} value={item.name}>\n                  {item.name}\n                </Option>\n              ))}\n            </Select>\n          )\n        },\n        {\n          key: 'fetchTop',\n          label: '置顶文章',\n          labelCol: 20,\n          wrapperCol: 4,\n          formItemProps: { className: 'form-checkbox-wrap' },\n          widget: <Checkbox />\n        }\n        // {\n        //   key: 'rangTime',\n        //   label: '创建时间',\n        //   widget: (\n        //     <RangePicker\n        //       ranges={{\n        //         Today: [moment(), moment()],\n        //         'This Month': [moment().startOf('month'), moment().endOf('month')]\n        //       }}\n        //       format=\"YYYY/MM/DD HH:mm:ss\"\n        //     />\n        //   )\n        // }\n      ]\n    }\n  }\n\n  handleSubmit = e => {\n    e.preventDefault()\n    this.props.form.validateFieldsAndScroll((errors, values) => {\n      if (errors) return\n      console.log('submit form: ', values)\n      this.props.getQuery(values)\n    })\n  }\n\n  render() {\n    return (\n      <div className=\"query-form\">\n        <Form layout=\"inline\" onSubmit={this.handleSubmit}>\n          <FormBuilder meta={this.getFormMeta()} form={this.props.form}>\n            <Button type=\"primary\" htmlType=\"submit\">\n              检索\n            </Button>\n          </FormBuilder>\n        </Form>\n      </div>\n    )\n  }\n}\n\nexport default Form.create()(QueryForm)\n"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACPA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AAMA;AAJA;AACA;AACA;AAFA;AAAA;;;;;;;;;;;;;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AALA;AACA;AAgBA;AACA;AACA;AAEA;AACA;AAFA;AAKA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AADA;AAKA;AATA;AAYA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AADA;AAKA;AATA;AAYA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAPA;AAUA;AACA;AACA;AAAA;AAAA;AAHA;AAMA;AACA;AACA;AAAA;AAAA;AAHA;AAMA;AACA;AACA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AANA;AAHA;AAeA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAKA;AAfA;AAkBA;AACA;AAMA;AACA;AACA;AAAA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAHA;AACA;AAIA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAVA;AAYA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;;;;;;AArJA;AAAA;AACA;AADA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;AA+IA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAWA;;;;AA/KA;AAkLA;;;;;;;;;;;ACjMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5CA;AAIA;AACA;AACA;AAEA;AACA;AAGA;AADA;AAAA;;;;;;;;;;;;;;;;;;AAMA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAHA;AAMA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AADA;AALA;AAcA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AADA;AALA;AAcA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArBA;AAlCA;AAyDA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;;;;;;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAOA;;;;AAtFA;AAyFA;;;;A","sourceRoot":""}